AULA_1: Introdu√ß√£o √†s F√≥rmulas DAX

    "pERMITE CRIAR FORMULAS INTELIGENTES PARA FAZER QUALAQUER TIPO DE ANALISE"


AULA_2: Introdu√ß√£o a Colunas Calculadas

    Colunas Calculadas:
        Selecionar Tabela > Bot√£o dirito > Crir coluna
        f_Vendas: 
            Tipo do Pedido = IF(fVendas[Qtd Vendida]=1,"Pedido Unico","Pedido M√∫ltiplo")
        

AULA_3: Introdu√ß√£o a Medidas (Parte 1)

    "Calculos unicos, que n√£o ir√£o aparecer na tabela"

    Medidas:
        Selecionar Tabela > Bot√£o dirito > Crir Medidas
        f_Vendas:
            Total de Vendas = SUM(fVendas[Qtd Vendida])
        f_Devolucao:
            Total Devolu√ß√µes = SUM('fDevolu√ß√µes'[Qtd Devolvida])
            % Devolu√ß√£o = [Total Devolu√ß√µes]/[Total de Vendas]


AULA_4: Introdu√ß√£o a Medidas (Parte 2)

    "A medida Sempre muda dependendo do contexto do filtro"


AULA_5: Recapitulando - Colunas Calculadas x Medidas

    Colunas Calculadas:
        Os valores s√£o Calculados baseados na informa√ß√£o de cada linha da tabela
        Acrescente uma nova coluna na tabela
        Recalcula de acordo com a altera√ß√£o nas celulas
        Geralmente usados no campos de linhas, colunas, ou filtros nas matrizes/graficos

    Medidas:
        Os valores s√£o Calculadas baseados nos filtros aplicados nas Matrizes
        N√£o Acrescenta novas colunas na tabela
        Recalcula de acordo com a altera√ß√£o nos filtros do Relatorio
        quase sempre usado no campo valores de uma Matriz/graficos


AULA_6: DAX - Sintaxe e Principais Operadores

    Total de Vendas = SUM(fVendas[Qtd Vendida])
    Nome da medida / Formula utilizada / Nome da tabela / nome da coluna

    Operador Matematico:
        + - * ^: Padr√£o
    
    Operador de Compara√ß√£o:
        = > < <= >= <>: Padr√£o

    Operador Logico:
        &  Concatenar
        && Condi√ß√£o E
        || Condi√ß√£o OU
        IN Condi√ß√£o OU com base em valores de uma lista


AULA_7: DAX - Principais F√≥rmulas

    Matematicoas e Estatisticas:
        Comuns:
            SUM, AVERAGE, MAX/MIN, DIVIDE, COUNT, COUNTROWS, DISTINCTCOUNT
        
        Iteradoras:
            SUMX, AVERAGEX, MAXX/MINX, COUNTX, RANKX
    
    Logicas:
        Comuns:
            IF, AND, OR, IFERROR, NOT, SWITCH
    
    filtro e de Tabela:
        Comuns
            CALCULATE, FILTER, ALL, RELATED, DISTINCT, VALUES, ETC...
    
    Data e Hora:
        Comuns:
            DATEDIFF, YEAR/MONTH/DAY, TODY/NOWM, WEEKDAY/WEEKNUM, ETC...


AULA_8: Fun√ß√£o IF

    Formula IF:
        "Separa vendas por Quinzena"
        d_Calendarrio:
            Coluna Calculada
            Quinzena = IF(DAY(dCalendario[Datas])>=15,"Quinzena 1","Quinzena 2")
        

AULA_9: Fun√ß√£o IF Aninhada

    "Coluna de Bimestre"
    d_Calendarrio:
        Coluna Calculada
        Bimestre = IF(dCalendario[M√™s]<=2,"Bimestre 1",
                    IF(dCalendario[M√™s]<=4,"Bimestre 2",
                        IF(dCalendario[M√™s]<=6,"Bimestre 3",
                            IF(dCalendario[M√™s]<=8,"Bimestre 4",
                                IF(dCalendario[M√™s]<=10,"Bimestre 5","Bimestre 6")))))


AULA_10: Fun√ß√£o SWITCH (Parte 1)

    "Coluna de Bimestre com SWITCH()"
    d_Calendarrio:
        Coluna Calculada
        Bimestre SWITCH = SWITCH(TRUE(),
            dCalendario[M√™s]<=2,"Bimestre 1",
                dCalendario[M√™s]<=4,"Bimestre 2",
                    dCalendario[M√™s]<=6,"Bimestre 3",
                        dCalendario[M√™s]<=8,"Bimestre 4",
                            dCalendario[M√™s]<=10,"Bimestre 5",
                            "Bimestre 6")
    
    "Faixa etaria de idade dos Clientes"
    d_Cliente
        Faixa Etaria = SWITCH(TRUE(),
            dClientes[Idade]<=19,"Jovem",
                dClientes[Idade]<=59,"Adulto",
                    "Senior")


AULA_11: Fun√ß√£o SWITCH (Parte 2)

    "Faixa etaria no Relatorio esta em uma ordem errada"
    "Criando uma coluna de numera√ß√£o em rela√ß√£o a faixa etaria para organizar a ordem"
    
    Coluna de Numera√ß√£o:
        Numera√ß√£o Faixa Etaria = SWITCH(TRUE(),
            dClientes[Idade]<=19,1,
                dClientes[Idade]<=59,2,
                    3)
    Para organizar:
        Selecionar Faixa Etaria > 
            Ferramentas de Coluna > Classificar Por Colunas: 
                Numera√ß√£o Faixa Etaria.
        "A ordem ser√° organizada na ordem da numera√ß√£o"

    "Simplificando SWITCH  se valores forem da mesma coluna e todos com = (Valores exatos)"
        Comum:
            Desconto = SWITCH(TRUE(),dClientes[Nivel Escolar]="P√≥s Gradua√ß√£o",0.2,dClientes[Nivel Escolar]="Superior Completo",0.1,dClientes[Nivel Escolar]="Superior Incompleto",0.05,0)
        Simplificado:
            Desconto = SWITCH(dClientes[Nivel Escolar],"P√≥s Gradua√ß√£o",0.2,"Superior Completo",0.1,"Superior Incompleto",0.05,0)


AULA_12: Fun√ß√£o RELATED

    "Permite buscar informa√ß√µes em outras tabelas"
    "S√≥ funciona se as duas tabelas estiverem RELACIONADAS"
    "Buscar pre√ßos de venda dos produtos"

    d_Produto
        Nova coluna
        Pre√ßo Unitario = RELATED(dProdutos[Pre√ßo Unitario])
        Nova coluna
        Faturamento = fVendas[Qtd Vendida]*fVendas[Pre√ßo Unitario]


AULA_13: IF com v√°rias condi√ß√µes (AND) - Desafio

    "Promo√ß√µes de dia das m√£es"
    Regras:
        "Sexo feminino"
        "Mais de 0 filhos"
        "Comprar no mes de Maio"


AULA_14: IF com v√°rias condi√ß√µes (AND) - Resolu√ß√£o

    f_Vendas
        Nova coluna
        Pre√ßo Dia das M√£es = 
            IF(RELATED(dClientes[Genero])="Feminino" &&
                RELATED(dClientes[Num Filhos])>=1 &&
                RELATED(dCalendario[M√™s])=5,
                    fVendas[Pre√ßo Unitario]*0.85,
                    fVendas[Pre√ßo Unitario])


AULA_15: IF com v√°rias condi√ß√µes (OR) / Colunas no Power Query x DAX

    "Separar Fim de Semana e Dia de Semana"
    d_Calendario
        Nova coluna
        Dia √ötil/Fim de Semana = 
            IF(dCalendario[Dia da Semana]=0 ||
                dCalendario[Dia da Semana]=6,
                "Fim de Semana",
                "Dia de Semana")


AULA_16: Calculando o Custo e Lucro da Venda

    d_Vendas
        Custo da Venda = fVendas[Qtd Vendida]*RELATED(dProdutos[Custo Unitario])
        Imposto = 0.1*fVendas[Faturamento]
        Lucro = fVendas[Faturamento]-fVendas[Custo da Venda]-fVendas[Imposto]

    // = Comentarios


AULA_17: Fun√ß√µes Matem√°ticas (Explica√ß√£o)

    "Explica√ß√£o das Fun√ß√µes (Matem√°ticas) mais utilizadas"


AULA_18: Fun√ß√µes SUM e AVERAGE

    "Lucro Total"
        Nova medida
        Lucro Total = SUM(fVendas[Lucro])
        Media de Faturamento = AVERAGE(fVendas[Faturamento])


AULA_19: Por que devo usar Medidas e n√£o s√≥ colunas

    "Margem de Lucro"
        Nova medida
        % Margem de Lucro = [Lucro Total]/SUM(fVendas[Faturamento])
    
    "Percentual n√£o pode se somar"
    "Por isso, n√£o Calcular por coluna, e sim por medida"


AULA_20: Fun√ß√µes MAX e MIN

    Maior faturamento:
        Nova Medida
        Maior Faturamento = MAX(fVendas[Faturamento])
        Menor Faturamento = MIN(fVendas[Faturamento])


AULA_21: Fun√ß√µes COUNT, COUNTROWS

    "Quantidade de clientes"
        Nova Media
        Qtd Clinetes = COUNT(dClientes[ID Cliente])
        COUNT: "Conta vlores preenchidos"

        Qtd Clinetes = COUNTROWS(dClientes)
        COUNTROWS: "Conta todas as linhas da tabela (independente de estar vazio)"


AULA_22: Fun√ß√£o DISTINCTCOUNT

    "Quantos clientes diferentes ja compraram"
        Nova Media
        Qtd Clientes que Compraram = DISTINCTCOUNT(fVendas[ID Cliente])
        Numero de Vendas = DISTINCTCOUNT(fVendas[Ordem de Compra])
        Marcas Distintas = DISTINCTCOUNT(dProdutos[Marca])
        Paises Atendidos = DISTINCTCOUNT(dLojas[Pa√≠s])


AULA_23: Criando Tabela para guardar as Medidas

    "Organizer as Medidas"
    "Criar tabela vazia para armazenar as medidas"

    Pagina inicial > Inserir Dados > Carregar - "Excluir todos linhas e colunas"
    Renomear: Medidas 

    Exportar todas medidas para tabela:
    Aba Relacionamento > Dados > Tabelas > Arrastar todas medidas para Tabela


AULA_24: Criando Pastas pra guardar as Medidas

    "Criar Subpastas para separar medidas"
    Aba Relacionamento > Selecionar Medida > Propriedades > Pasta de exibi√ß√£o > Nomear Pasta;
    Arrastar todas medidas para pasta

    Excluir Media ou coluna rapidamente:
        Selecionar > Delete
    

AULA_25: An√°lise Drill Down (Parte 1)

    Visual de Matriz:
        "Neste visual podemos ir detalhando os dados em topicos e subtopicos"
        Marca > Produto > Loja X Qtd de Vendas


AULA_26: An√°lise Drill Down (Parte 2)

    Visual de Matriz:
        "Podemos adiconar varios valores na analise"
        Qtd Vendas, Faturamento, etc..

        Seta para baixo (‚¨á):
            "Mostra somente o valor selecionado em foco"
        Seta para cima (‚¨Ü):
            "Mostra somente valores do nivel a cima"
        Duas cetas para baixo (‚¨á‚¨á):
            "Mostra somente valores do nivel a baixo"
        "Tridente" para baixo (üîÄ): 
            "Expande todo os niveis"


AULA_27: Fun√ß√£o CALCULATE (Parte 1)

    "Calcula uma express√£o ou uma formula a partir dos filtros indicados"
    =CALCULATE(express√£o;[filtro 1];[filtro 2];...)


AULA_28: Fun√ß√£o CALCULATE (Parte 2)

    "Total de vendas de Celular"
        Nova medida
        Vendas Celular = CALCULATE([Total de Vendas],dProdutos[Tipo do Produto] = "Celular")


AULA_29: Fun√ß√£o CALCULATE (Parte 3)

    "Filtro que √© feito na formula CALCULATE, sobreescreve qualquer outro filtro que tenha"
    "Filtro de Celular na medida anterior, se jogado em uma Matriz que tenha tipo de produtos como filtro, valores ir√° se perder"


AULA_30: Fun√ß√£o CALCULATE (Parte 4)

    "Vendas online"
        Vendas Online = CALCULATE([Total de Vendas],dLojas[Tipo] = "Online")
        % Vendas Online = [Vendas Online]/[Total de Vendas]

    "Podemos usar mais de um filtro na formula CALCULATE"

    Vendas Celular 2020 = CALCULATE([Total de Vendas],dProdutos[Tipo do Produto] = "Celular",dCalendario[Ano] = 2020)
    Vendas Apple ou Samsung = CALCULATE([Faturamento total],dProdutos[Marca] = "Samsung" || dProdutos[Marca] = "Apple")


AULA_31: Fun√ß√£o ALL (Parte 1)

    "Retorna todas as linhas de uma tabela ou todas as celulas de uma coluna, desconsiderando e ignorando qualquer filtro"
    =ALL(Tabela ou Coluna, [Coluna 1],[Coluna 2],...)


AULA_32: Fun√ß√£o ALL (Parte 2)

    "Numero absolute de vendas para calcular a porcentagen de vendas"
        Nova medida
        Total Vendas Absoluto = CALCULATE([Total de Vendas],ALL(fVendas))
        % Vendas ALL = [Total de Vendas]/[Total Vendas Absoluto]

    "Com a fun√ß√£o ALL o calculo ira remover o filtro da Coluna/tabela escolhida"


AULA_33: Fun√ß√£o ALL (Parte 3)

    Total Vendas Absoluto = CALCULATE([Total de Vendas],ALL(dProdutos))
    "Quando colocamos uma segmenta√ß√£o de dados de Continete, o valor Absoluto ira respeitar o filtro, pois ALL so esta removendo o filtro da dProdutos"

    "Para mostratar o Valor Absoluto geral precisamos mustar a da tabela do ALL para fVendas"
    Total Vendas Absoluto = CALCULATE([Total de Vendas],ALL(fVendas))
    "Agora a formula n√£o ira aceitar filtro de nenhuma tabela dimens√£o, pois a tabela fVendas conta todos os dados de vendas"


AULA_34: Exerc√≠cio Fun√ß√£o ALL

    "% Faturamento por pais, filtrando por marcas"
        Total Faturamento Absoluto = CALCULATE([Faturamento total],ALL(dLojas))
        % Faturamento ALL = DIVIDE([Faturamento total],[Total Faturamento Absoluto],"Sem Vendas")


AULA_35: Calculando % do Subtotal

    "Calculando subtotais da matriz, % dos paises para aquele continente"
        Total Faturamento Absoluto = CALCULATE([Faturamento total],ALL(dLojas[Pa√≠s]))
    "Com isso cada continete ira ficar com 100%"

    "Podemos adicionar uma coluna com % Global, Para divir os paise e continemtes de uma forma geral"
        Total Faturamento Absoluto (Global) = CALCULATE([Faturamento total],ALL(dLojas))
        % Faturamento ALL (Global) = DIVIDE([Faturamento total],[Total Faturamento Absoluto (Global)],"Sem Vendas")


AULA_36: Exerc√≠cio - % do Subtotal

    "% e Total de vendas por tipo produtos e nome, com subtotal de % por nome produto"
        Total Vendas Absoluto = CALCULATE([Total de Vendas],ALL(fVendas))
        % Vendas ALL = [Total de Vendas]/[Total Vendas Absoluto]

        Total Vendas Absoluto subtotal = CALCULATE([Total de Vendas],ALL(dProdutos[Nome Produto]))
        % Vendas ALL subtotal = [Total de Vendas]/[Total Vendas Absoluto subtotal]


AULA_37: Novo Layout da Guia Relat√≥rio no Power BI

    "Apresenta√ß√£o de atualiza√ß√£o do Power Bi"


AULA_38: Fun√ß√µes Iteradoras (X) - Explica√ß√£o

    "Fazem algum calculo linha por linha da tabela e dopis aplicam alguma agrega√ß√£o (soma, media, minimo, maximo, etc)"
    =SUMX(Tabela, Express√£o)
    =COUNTX()
    =AVERAGEX()
    =MAXX()/MINX()
    =RANKX()
    

AULA_39: Fun√ß√£o SUMX (Parte 1)

    "SUM()= Somar os valores de uma coluna que voce ja tem";
    "SUMX()= Somar os valores de uma coluna que voce n√£o tem"

    Faturamento Total = SUMX(fVendas,fVendas[Qtd Vendida]*fVendas[Pre√ßo Unitario])


AULA_40: Fun√ß√£o SUMX (Parte 2)

    "Faturamento total com melhor desempenho"
        Faturamento Total = SUMX(
            fVendas,
            fVendas[Qtd Vendida]*RELATED(dProdutos[Pre√ßo Unitario])
        )

    "Com essa nova formula podemas Excluir as colunas calculadas de Faturamento e Pre√ßo Unitario da f_Vendas"


AULA_41: SUMX, AVERAGEX, MAXX & MINX

    "Faturamento medio"
        Faturamento M√©dio = SUMX(
            fVendas,
            fVendas[Qtd Vendida]*RELATED(dProdutos[Pre√ßo Unitario])
        )


AULA_42: Exerc√≠cio - Fun√ß√µes Iteradoras

    "Calcule o lucro total da empresa, considerando 10% de impost sobre a receita"
        Lucro Total = SUMX(
            fVendas,
            (fVendas[Qtd Vendida]*RELATED(dProdutos[Pre√ßo Unitario]))*0.9 - //Receita descontando o imposto
            (fVendas[Qtd Vendida]*RELATED(dProdutos[Custo Unitario])) //Custo das vendas
        )
    
    "Lucro medio por transa√ß√£o"
        Lucro Medio = AVERAGEX(
            fVendas,
            (fVendas[Qtd Vendida]*RELATED(dProdutos[Pre√ßo Unitario]))*0.9 - //Receita descontando o imposto
            (fVendas[Qtd Vendida]*RELATED(dProdutos[Custo Unitario])) //Custo das vendas
        )

    "Prejuizo total causado pelas devolu√ß√µes"
        Prejuizo Devolu√ß√µes = SUMX(
            'fDevolu√ß√µes',
            'fDevolu√ß√µes'[Qtd Devolvida]*RELATED(dProdutos[Pre√ßo Unitario])
        )


AULA_43: Criando Tabela Calend√°rio com DAX

    "Nova formula para dCalendario"
        Nova Tabela
        dCalendario = CALENDAR(
            DATE(2020,01,01),
            DATE(2022,12,31)
        )
        "Sempre come√ßar no 01/01 do ano desejado e terminar no 31/12 do ano desejado"


AULA_44: Deixando a Tabela Calend√°rio Autom√°tica

    "dCalendario automatica"
        Nova Tabela
        dCalendario = CALENDAR(
            DATE(YEAR(MIN(fVendas[Data da Venda])),01,01),
            DATE(YEAR(MAX(fVendas[Data da Venda])),12,31)
        )


AULA_45: Fun√ß√µes de DATA _ Cria√ß√£o dos Relacionamentos

    "Tablas criadas com formula DAX, N√£o podem ser alteradas pelo Power Query"

    Ano = YEAR(dCalendario[Date]);
    Num M√™s = MONTH(dCalendario[Date]);
    Nome M√™s = dCalendario[Date].[M√™s];
    Inicio do M√™s = STARTOFMONTH(dCalendario[Date]);
    Num Trimestre = QUARTER(dCalendario[Date]);
    Nome Trimestre = dCalendario[Date].[Trimestre];

    Relacionar Date com Datas das Tabelas Fato.


AULA_46: Fun√ß√µes de Intelig√™ncia de Tempo - Explica√ß√£o

    "Permitem criar ompara√ß√µes e analises inteligentes como acumulado do ano, acumulado dos ultimos x dias, compara√ß√£o com o mesmo periodo do ano anterior, etc"

    CALCULATE(Medida; DATESYTD(d_Calendario[Date]))
    TOTALYTD(Medida; d_Calendario[Date])

    CALCULATE(Medida; DATESMTD(d_Calendario[Date]))
    TOTALMTD(Medida; d_Calendario[Date])


AULA_47: Acumulado no Ano - Fun√ß√£o DATESYTD

    "Faturamento acumulado do ano"
        Faturamento YTD = CALCULATE(
            [Faturamento Total],
            DATESYTD(dCalendario[Date])
        )


AULA_48: Acumulado no Ano - Fun√ß√£o TOTALYTD & Mudan√ßa de Per√≠odo Fiscal
    
    "Faturamento acumulado do ano - 2"
        Faturamento YTD 2 = TOTALYTD(
            [Faturamento Total],
            dCalendario[Date]
        )


AULA_49: Acumulado no M√™s e Trimestre (MTD e QTD)

    "Faturamento acumulado do M√™s"
        Faturamento MTD = CALCULATE(
            [Faturamento Total],
            DATESMTD(dCalendario[Date])
        )
        Faturamento MTD 2 = TOTALMTD(
            [Faturamento Total], 
            dCalendario[Date]
        )
    
    "Faturamento acumulado do QUARTER"
        Faturamento QTD = CALCULATE(
            [Faturamento Total],
            DATESQTD(dCalendario[Date])
        )


AULA_50: DATEADD - Compara√ß√£o Entre Per√≠odos (Parte 1)

    "faturamento do m√™s anterior"
        Faturamento M√™s Anterior = CALCULATE(
            [Faturamento Total],
            DATEADD(dCalendario[Date],-1,MONTH)
        )
        DATEADD(): "Desloca m√™s para tras ou para frente"

    "% Crescimento m√™s por m√™s"
        % Crescimento MoM = ([Faturamento Total]-[Faturamento M√™s Anterior])/[Faturamento M√™s Anterior]
        % Crescimento MoM 2 = DIVIDE([Faturamento Total]-[Faturamento M√™s Anterior],[Faturamento M√™s Anterior])
        DIVIDE(): "ja identifica os valores com erro e FORMATA de infinito pra 0"
    

AULA_51: DATEADD - Compara√ß√£o Entre Per√≠odos (Parte 2)

    "Compara um ano com outro"
        Faturamento Ano Anterior = CALCULATE(
            [Faturamento Total],
            DATEADD(dCalendario[Date],-1,YEAR)
        )
    
    "% Crescimento anual"
        % Crescimento YoY = ([Faturamento Total]-[Faturamento Ano Anterior])/[Faturamento Ano Anterior]
        % Crescimento YoY 2 = DIVIDE([Faturamento Total]-[Faturamento Ano Anterior],[Faturamento Ano Anterior])


AULA_52: DATEADD - Compara√ß√£o Entre Per√≠odos (Parte 3)

    "Coluna de filtro para data que tenha venda"
        Nova coluna - dCalendario
        Data vigente? = IF(
            dCalendario[Date]<=MAX(fVendas[Data da Venda]),
            "SIM",
            "N√ÉO"
        )
    "Filtrar matriz com Data vigente = SIM, PARA RETIRAR MESES VAZIOS"


AULA_53: DATEADD - Compara√ß√£o Entre Per√≠odos (Parte 4)

    "Formula para retornar CALCULO somente de um valor, ano por ano (n√£o vai retonar o TOTAL por exemplo, pois s√£o 3 anos, 3 valores)"
        % Crescimento YoY 2 = IF(
            HASONEVALUE(dCalendario[Ano]),
            DIVIDE([Faturamento Total]-[Faturamento Ano Anterior],[Faturamento Ano Anterior])
        )
        "precisar ser usado com IF pois Func√ß√£o HASONEVALUE tem retorno booleano"


