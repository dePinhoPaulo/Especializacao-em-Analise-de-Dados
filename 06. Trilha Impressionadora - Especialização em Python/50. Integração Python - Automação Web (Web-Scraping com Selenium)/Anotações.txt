AULA_1: Leia antes de começar

    Nesse módulo vamos aprender a criar "automação na internet" para os nossos códigos usando o selenium.


AULA_2: Instalação e Configurações Importantes do Selenium (Assista)

    Para fazer scraping use o Chrome!

    Instalação:

        Biblioteca do Selenium:
            pip install --upgrade selenium

        Webdriver-manager
            pip install webdriver-manager

        importar o ChromeDriverManager e usar ele no Serviço do Selenium:
            from selenium import webdriver
            from selenium.webdriver.chrome.service import Service
            from webdriver_manager.chrome import ChromeDriverManager

            servico = Service(ChromeDriverManager().install())
            navegador = webdriver.Chrome(service=servico)
            #Codigo padrão


AULA_3: Diferença do Selenium no Google Colab

    Instruções para quem usa Colab;


AULA_4: Como acessar uma página com o selenium

    Codigo padrão para usar:
        from selenium import webdriver
        from selenium.webdriver.chrome.service import Service
        from webdriver_manager.chrome import ChromeDriverManager
        servico = Service(ChromeDriverManager().install())
        navegador = webdriver.Chrome(service=servico)

    Acessando paginas com Selenium:

        navegador.get(r"https://www.amazon.com.br/")


AULA_5: Métodos de Seleção do Selenium

    Selecionando elementos do html:
        navegadaor.find_element -> 1 item
        navegadaor.find_elements -> lista

    Enviar dados em compos:
        .send_keys("")

    Clicar:
        .click()

    *Documentação Selenium Python


AULA_6: Seleção por Class Name e XPATH

    Explicação da estrutura de um HTML.
        <div>, <span>;
        class, id;

    Selecionar elementos por id:
        "Geralmente são unicos na pagima"

    Selecionar elementos por XPATH:
        "Seleciona elemento com Inspecionar"
        "Botão direito na div do elemento, Copiar XPATH"
    
    Ordem de prioridade:
        -Id;
        -Class Name;
        -XPATH

AULA_7: Outras formas de selecionar um elemento no Selenium

    Selecionar pelo Partial Link Text:
        "Pega por algum fragmento do texto"
        navegador.find_element(By.PARTIAL_LINK_TEXT, 'WhatsApp').text

    Selecionar pela tag:
        navegador.find_element(By.TAG_NAME, 'h2').text


AULA_8: Selecionando vários elementos de uma vez

    Selecionar vários elementos de uma vez:
        "Percorrer por um grupo de elementos e clicar"
        lista_elementos = navegador.find_elements(By.CLASS_NAME, 'nav-link')
        for elemento in lista_elementos:
            if 'blog' in elemento.text.lower():
                elemento.click()
                break
        "Sempre utilizar break para finalizar o loop nestes casos"


AULA_9: Pegando atributos ou texto de um elemento

    Selecionando atributos de um elemento:
        navegador.find_element(By.XPATH, '/html/body/footer/div/div[1]/div[2]/div/a[2]').get_attribute('href')


AULA_10: Estrutura da Árvore HTML

    Estrutura HTML:
        <html>
            <header> </header>

            <body> -> Parent
                <a> </a> -> Child
            </body>
        </html>


AULA_11: Pegando Informações de Elementos dentro de Elementos

    *buscar alguma tag/id/class que contenha nos elementos desejados.
    
    Percorrer as imagens da pagina:
        lista_imagens = navegador.find_elements(By.TAG_NAME, 'figure')
        for elemento in lista_imagens:   #Percorre as imagens da pagina
            #Imprime os links: 
                link = elemento.find_element(By.TAG_NAME, 'a').get_attribute('href')
                print(link)
    
    Retorna somente as imagens que tem link:
        *melhoria do codigo anterior
        links = elemento.find_elements(By.TAG_NAME, 'a')
        if links != []:   #pega somente as imagens que tem link
            link = elemento.find_element(By.TAG_NAME, 'a').get_attribute('href')    #retorna o link
            print(link)


AULA_12: Preenchendo formulários com o Selenium (botões e caixas de seleção)

    Interagir em um PopUp:
        alerta = navegador.switch_to.alert   #Vai para o popup
        alerta.accept()   #clica no OK

    Verificar o valor de um CheckBox:
        navegador.find_element(By.XPATH, '/html/body/form/input[3]').is_selected()   #Retorna valor do checkbox


AULA_13: Campos de Texto Personalizado e Datas

    Mudar campo de seleção de cor:
        navegador.find_element(By.XPATH, '/html/body/form/input[4]').send_keys('#aa1d1d')
        "Codigo da cor em HEX"
    
    Retornar valor do campo de seleção:
        valor_cor = navegador.find_element(By.XPATH, '/html/body/form/input[4]').get_attribute('value')
        print(valor_cor)

    Inserir campo de texto:
        navegador.find_element(By.XPATH, '/html/body/form/input[16]').send_keys('Flamengo')
    
    Inserindo e pegando data:
        navegador.find_element(By.XPATH, '/html/body/form/input[6]').send_keys('10/23/2001')

        valor_data = navegador.find_element(By.XPATH, '/html/body/form/input[6]').get_attribute('value')
        print(valor_data)
        "Se atentar aos formato das datas"


AULA_14: Campos com Várias Informações e de Arquivos

    Inserir data e hora:
        navegador.find_element(By.XPATH, '/html/body/form/input[7]').send_keys('10/23/2001\t12:30\tAM')
            "\t é o uma fora de TAB na inserção dos dados"

        from selenium.webdriver.common.keys import Keys
        navegador.find_element(By.XPATH, '/html/body/form/input[7]').send_keys('10/30/2001', Keys.TAB, '05:00', Keys.TAB, 'PM')
            "aqui utilizado Keys do selenium para dar TAB"
    

AULA_15: Exercitando em outros campos 

    Clicando no Radio Button:
        navegador.find_element(By.XPATH, '/html/body/form/input[13]').click()
        valor_radio_button = navegador.find_element(By.XPATH, '/html/body/form/input[13]').is_selected()
        print(valor_radio_button)

    Inserindo data(Semana Ano):
        navegador.find_element(By.XPATH, '/html/body/form/input[18]').send_keys('50\t2025')

    Inserir texto:
        navegador.find_element(By.XPATH, '//*[@id="story"]').send_keys('Ola\nMeu nome é Paulo\n24 anos')
            "Podemos utilizar o \n ou Keys.ENTER para quebrar linhas"


AULA_16: Campos de Arrastar

    Mover Slider:
        elemento_slider = navegador.find_element(By.XPATH, '/html/body/form/input[15]')
        elemento_slider.clear()
        for i in range(100 - 50):
            elemento_slider.send_keys(Keys.ARROW_RIGHT)
        "Utilizar for para apertar seta para direira ou esquedar (Valor 50 pq este é o padrão)"


AULA_17: Campos de Lista de Valores

    Selecionar lista suspença:
        import time
        navegador.find_element(By.XPATH, '/html/body/form/select[1]').click()   #Abrir lista
        time.sleep(0.5)   #Esperar meio segundo
        navegador.find_element(By.XPATH, '/html/body/form/select[1]/option[2]').click()   #clicar na opção


AULA_18: Usando o Select e discussão sobre erros no Selenium

    Verificar documentação: https://www.selenium.dev/pt-br/documentation/webdriver/elements/select_lists/

    Selecionar valor em lista suspensa com Select:
        elemento = navegador.find_element(By.TAG_NAME, 'select')
        elemento_select = Select(elemento)
        elemento_select.select_by_visible_text('C')

    Pegando valor em lista suspensa com Select:
    item = elemento_select.first_selected_option
    print(item.get_attribute('value'))


AULA_19: Exercício - Automatizar Emissão de Nota Fiscal

    Mapeando os passos que serão feitos pela automação;
    Importando as bibliotecas necessarias;
    Encontrando elementos por: XPATH, CLASS_NAME, NAME;
    "Todo contudo aprendido antes"


AULA_20: Exercício - Automatizar Emissão de Nota Fiscal - Autorizando Download Automaticamente

    "Continuação do Projeto"

    Ajustes de liberação do download no Google chrome:
        "Solução muito especifica, sempre vai ser praticamente o mesmo codigo"


AULA_21: Exercício - Automatizar Emissão de Nota Fiscal - Várias notas ao mesmo tempo

    Utilizando pandas para importar os dados da planilha;
    Utilizar for para Percorrer todas linhas da planilha;
    Utilizar Refresh para refcarregar a pagina a cada preenchimento;


AULA_22: ActionChains e Dropdowns Especiais

    Biblioteca para simular movimento do mouse no navegador:
        from selenium.webdriver import ActionChains
        checar documentação: https://www.selenium.dev/pt-br/documentation/webdriver/actions_api/mouse/

    Separa em passos:
        menu = navegador.find_element(By.XPATH, '//*[@id="menu-item-dropdown-16313"]')
        item = navegador.find_element(By.XPATH, '//*[@id="menu-item-17042"]/a')
        "Menu que sera passado o mouse e item para clicar"

    Colocar o mouse em cima do menu:
        ActionChains(navegador).move_to_element(menu).perform()


AULA_23: Alertas no Selenium

    Pop Up é diferente de um Alerta:
        PopUp faz parte do site;
        Alerta é do navegador;
    
    Medar para alerta simples:
        alerta = navegador.switch_to.alert
    
    Mudar para alerta com a biblioteca:
        from selenium.webdriver.common.alert import Alert
        alerta = Alert(navegador)
    
    Aceitar/Cancelar alerta:
        alerta.accept()
        alerta.dismiss()

    Pegar texto:
        texto = alerta.text
        print(texto)

    Enviar texto:
        alerta.send_keys('Mengo')


AULA_24: Trabalhando com Diferentes Abas e Janelas

    window_handles:
        "A ordem é de acordor com a abertura da aba"
        "NÃO a posição do navegador"
    
    trocar janela:
        "funciona da mesma forma da troca de aba"
        "se atentar a ordem de criação da aba desta nova janela "
    
    Listar abas ja abertas:
        lista_abas = navegador.window_handles
        print(list(lista_abas))
    
    mudar para uma aba especifica:
        aba_sql = navegador.window_handles[4]
        navegador.switch_to.window(aba_sql)
    
    fechar aba:
        navegador.close()
    
    fechar navegadir:
        navegador.quit()


AULA_25: Como esperar uma informação carregar na tela

    Fechar PopUp com tempo fixo;
        "Fixa uma quantidade de segundos até aparecer o elemento"

    Fechar PopUp com Loop:
        "Forma Automatizado onde adiciona 1 seg enquanto não aparecer o elemento"

    Fechar PopUp com WebDriverWait;
        "Biblioteca que faz de forma automatica"
        "Passamos como parametro (navegador, tempo_maximo_esoera, find_element)"


AULA_26: Exercício - Processo de Consulta em sites

    Exercício Parte 1: OK


AULA_27: Exercício - Processo de Consulta em sites - Várias consultas de uma vez

    Exercício Parte 2: OK


AULA_28: Printscreen com Selenium

    Tirar pint:
        navegador.save_screenshot('print.png')

    Recortar print:

        Importar print:
            from PIL import Image
            imagem = Image.open('print.png')
        
        Pegando posica e tamanho do corte:
            elemento = navegador.find_element(By.ID, 'header')
            posicao = elemento.location
            tamanho = elemento.size

        Parametros de corte e salvar:
            x_ini = posicao['x'] * 1.25 # descontando zoom da tela
            y_ini = posicao['y'] * 1.25 
            x_fin = tamanho['width'] * 1.25
            y_fin = tamanho['height'] * 1.25
            
            imagem = imagem.crop((x_ini, y_ini, x_fin, y_fin))
            imagem.save('print_cortado.png')


AULA_29: Gerenciando a tela do Navegador

    Maximizar e Minimizar:
        navegador.maximize_window()
        navegador.minimize_window()

    Roda no navegador em segundo plano (alguns sites funcionam diferente no modo headless):
        options = webdriver.ChromeOptions()
        options.add_argument('--headless')
        novo_navegador = webdriver.Chrome(service=servico, options=options)


AULA_30: Carregando um navegador com Cookies e Logins

    Abrir perfil especifico no navegador:
        servico = Service(ChromeDriverManager().install())
        options = webdriver.ChromeOptions()
        options.add_argument(r'user-data-dir=C:\Users\Kiko\AppData\Local\Temp\scoped_dir19712_1658152173\Default')   # caminho para achar pasta de seleção do perfil: chrome://version/
        navegador = webdriver.Chrome(service=servico, options=options)

        "Bom para não ter que ficar re-abrindo WhatsApp Web"


AULA_31: Aviso - Atualizações de Sites e dos XPath, Class, ID e outros

    Sites sempre atualizam seus front-ends;
    Sempre construir um codigo muito organizado para adaptar os novos XPath, Class, ID...

